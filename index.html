<!DOCTYPE html>
<html>
<head>
    <title>Home</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./css/style.css">
</head>
<body>
    <header>
      <a href="./" class="header-logo">---</a>
      <a href="./" class="header-brand"> SKG </a>
      <a href="#" class="bar"></a>
      <nav>
          <ul>
            <li><a href="./tryhackme/index"> Tryhackme </a> </li>
            <li><a href="./cryptohack/index"> Cryptohack </a> </li>
            <li><a href="./rootme/index"> Rootme </a> </li>
            <li><a href="./whoami"> WhoAmI </a> </li>
          </ul>

          <div id="dropdown-header" class="dropdown">
            <button class="dropbtn"> Code Snippet </button>
              <div class="dropdown-content active">
                <a href="./"> CODE </a>
                <a href="./"> CODE </a>
                <a href="./"> CODE </a>
                <a href="./"> CODE </a>
                <a href="./"> CODE </a>

             </div>
          </div>
    </nav>
    <div class="menu-toggle">
      <i class="fa fa-bars" aria-hidden="true"></i>
    </div>
  </header>
<main>
    <div class="swipe-area"></div>

    <br><br><br>
    <div class="container">
      <article role="article">
    		<h3> CryptoHack - General </h3>
        <br>

        <dl class="toc">
          <h4> Table of Contents </h4>
          <ol>
            <h5> Encoding </h5>
            <li> <a href="#enc-ascii"> ASCII - Points: 5 </a></li>
            <li> <a href="#enc-hex"> Hex - Points: 5 </a></li>
            <li> <a href="#enc-base64"> Base64 - Points: 10 </a></li>
            <li> <a href="#enc-bytes-bigint"> Bytes and Big Integers - Points: 10 </a></li>
            <li> <a href="#enc-challenge"> Encoding Challenge - Points: 40 </a></li>
          </ol>
          <hr style="margin-bottom: 0em; width: 20%; margin-left: 42%;">
          <ol>
            <h5> XOR </h5>
            <li> <a href="#xor-starter"> XOR Starter - Points: 10 </a></li>
            <li> <a href="#xor-properties"> XOR Properties - Points: 15 </a></li>
            <li> <a href="#xor-fav-byte"> Favourite byte - Points: 20 </a></li>
            <li> <a href="#xor-know-xor-dont"> You either know, XOR you don't - Points: 30 </a></li>
            <li> <a href="#xor-lemur"> Lemur XOR - Points: 40 </a></li>
          </ol>
          <ol>
            <h5> Mathematics </h5>
            <li> <a href="#math-gcd"> Greatest Common Divisor - Points: 15 </a></li>
            <li> <a href="#math-extended-gcd"> Extended GCD - Points: 20 </a></li>
          </ol>

        </dl>
        <hr style="margin-bottom: 3em; width: 30%; margin-left: 35%;">

<!-- Start Post  -->
        <dl class="anchor" id="enc-ascii">
          <dt> ASCII - Points: 5 </dt>
          <dd>
            ASCII is a 7-bit encoding standard which allows the representation of text using the integers 0-127. Using the below integer array, convert the numbers to their corresponding ASCII characters to obtain a flag. <code>[99,114,121,112,116,111,123, 65,83,67,73,73,95,112,114, 49,110,116,52,98,108,51,125]</code>
          </dd>
        </dl>

        <div class="row-full code">
          <div class="code-toolbar"><pre class=" language-python"><code class="prism  language-python">ASCII<span class="token space"> </span><span class="token operator">=</span><span class="token space"> </span><span class="token punctuation">[</span><span class="token number">99</span><span class="token punctuation">,</span><span class="token space"> </span><span class="token number">114</span><span class="token punctuation">,</span><span class="token space"> </span><span class="token number">121</span><span class="token punctuation">,</span><span class="token space"> </span><span class="token number">112</span><span class="token punctuation">,</span><span class="token space"> </span><span class="token number">116</span><span class="token punctuation">,</span><span class="token space"> </span><span class="token number">111</span><span class="token punctuation">,</span><span class="token space"> </span><span class="token number">123</span><span class="token punctuation">,</span><span class="token space"> </span><span class="token number">65</span><span class="token punctuation">,</span><span class="token space"> </span><span class="token number">83</span><span class="token punctuation">,</span><span class="token space"> </span><span class="token number">67</span><span class="token punctuation">,</span><span class="token space"> </span><span class="token number">73</span><span class="token punctuation">,</span><span class="token space"> </span><span class="token number">73</span><span class="token punctuation">,</span><span class="token space"> </span><span class="token number">95</span><span class="token punctuation">,</span><span class="token space"> </span><span class="token number">112</span><span class="token punctuation">,</span><span class="token space"> </span><span class="token number">114</span><span class="token punctuation">,</span><span class="token lf">
</span><span class="token number">49</span><span class="token punctuation">,</span><span class="token space"> </span><span class="token number">110</span><span class="token punctuation">,</span><span class="token space"> </span><span class="token number">116</span><span class="token punctuation">,</span><span class="token space"> </span><span class="token number">52</span><span class="token punctuation">,</span><span class="token space"> </span><span class="token number">98</span><span class="token punctuation">,</span><span class="token space"> </span><span class="token number">108</span><span class="token punctuation">,</span><span class="token space"> </span><span class="token number">51</span><span class="token punctuation">,</span><span class="token space"> </span><span class="token number">125</span><span class="token punctuation">]</span><span class="token lf">
</span>flag<span class="token space"> </span><span class="token operator">=</span><span class="token space"> </span><span class="token string">''</span><span class="token lf">
</span><span class="token lf">
</span><span class="token keyword keyword-for">for</span><span class="token space"> </span>c<span class="token space"> </span><span class="token keyword keyword-in">in</span><span class="token space"> </span>ASCII<span class="token punctuation">:</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span>flag<span class="token space"> </span><span class="token operator">+=</span><span class="token space"> </span><span class="token builtin">chr</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token lf">
</span><span class="token lf">
</span><span class="token keyword keyword-print">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span></code></pre><div class="toolbar"><div class="toolbar-item"><button>Copy</button></div></div></div>
        </div>

        <dl>
          Convert each integer to character to get the flag
        </dl>

        <div class="row-full code">
          <div class="code-toolbar"><pre class=" language-bash"><code class="prism  language-bash">$<span class="token space"> </span>python3<span class="token space"> </span>ascii.py<span class="token lf">
</span><span class="token comment">#<span class="token space"> </span>crypto{ASCII_pr1nt4bl3}</span></code></pre><div class="toolbar"><div class="toolbar-item"><button>Copy</button></div></div></div>
        </div>

        <div class="scrolling-wrapper">
        <dl>
          <blockquote>
            <p class="ctf"><strong> crypto{ASCII_pr1nt4bl3} </strong></p>
          </blockquote>
        </dl>
        </div>
        <hr>
<!-- Finish post  -->
<!-- Start Post  -->
        <dl class="anchor" id="enc-hex">
          <dt> Hex - Points: 5 </dt>
          <dd>
            When we encrypt something the resulting ciphertext commonly has bytes which are not printable ASCII characters. If we want to share our encrypted data, it's common to  encode it into something more user-friendly and portable across  different systems. Included below is a the flag encoded as a hex string. Decode this back into bytes to get the flag. <code>  63727970746f7b596f755f77696c6c5f62655f776f726b696e675f776974685f6865785f737472696e67735f615f6c6f747d </code>
          </dd>
        </dl>

        <div class="row-full code">
          <div class="code-toolbar"><pre class=" language-python"><code class="prism  language-python"><span class="token keyword keyword-from">from</span><span class="token space"> </span>binascii<span class="token space"> </span><span class="token keyword keyword-import">import</span><span class="token space"> </span>unhexlify<span class="token lf">
</span><span class="token lf">
</span>flag<span class="token space"> </span><span class="token operator">=</span><span class="token space"> </span><span class="token lf">
</span>unhexlify<span class="token punctuation">(</span><span class="token string">b'63727970746f7b596f755f77696c6c5f62655f776f726b696e675f776974685f6865785f737472696e67735f615f6c6f747d'</span><span class="token punctuation">)</span><span class="token lf">
</span><span class="token keyword keyword-print">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span></code></pre><div class="toolbar"><div class="toolbar-item"><button>Copy</button></div></div></div>
        </div>

        <dl>
          Decode hex to get the flag
        </dl>

        <div class="row-full code">
          <div class="code-toolbar"><pre class=" language-bash"><code class="prism  language-bash">$<span class="token space"> </span>python3<span class="token space"> </span>hex.py<span class="token lf">
</span><span class="token comment">#<span class="token space"> </span>b'crypto{You_will_be_working_with_hex_strings_a_lot}'</span></code></pre><div class="toolbar"><div class="toolbar-item"><button>Copy</button></div></div></div>
        </div>

        <div class="scrolling-wrapper">
        <dl>
          <blockquote>
            <p class="ctf"><strong> crypto{You_will_be_working_with_hex_strings_a_lot} </strong></p>
          </blockquote>
        </dl>
        </div>
        <hr>
<!-- Finish post  -->
<!-- Start Post  -->
        <dl class="anchor" id="enc-base64">
          <dt> Base64 - Points: 10 </dt>
          <dd>
            Another common encoding scheme is Base64, which allows us to represent binary data as an ASCII string using 64 characters. One character of a Base64 string encodes 6 bits, and so 4 characters of Base64 encodes three 8-bit bytes. Base64 is most commonly used online, where binary data such as images can be easy included into html or css files. Take the below hex string, decode it into bytes and then encode it into Base64. <br>
            <code>  72bca9b68fc16ac7beeb8f849dca1d8a783e8acf9679bf9269f7bf </code>
          </dd>
        </dl>

        <div class="row-full code">
          <div class="code-toolbar"><pre class=" language-python"><code class="prism  language-python"><span class="token keyword keyword-import">import</span><span class="token space"> </span>base64<span class="token lf">
</span><span class="token keyword keyword-from">from</span><span class="token space"> </span>binascii<span class="token space"> </span><span class="token keyword keyword-import">import</span><span class="token space"> </span>unhexlify<span class="token lf">
</span><span class="token lf">
</span><span class="token builtin">hex</span><span class="token space"> </span><span class="token operator">=</span><span class="token space"> </span>unhexlify<span class="token punctuation">(</span><span class="token string">'72bca9b68fc16ac7beeb8f849dca1d8a783e8acf9679bf9269f7bf'</span><span class="token punctuation">)</span><span class="token lf">
</span>flag<span class="token space"> </span><span class="token operator">=</span><span class="token space"> </span>base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span><span class="token builtin">hex</span><span class="token punctuation">)</span><span class="token lf">
</span><span class="token keyword keyword-print">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span></code></pre><div class="toolbar"><div class="toolbar-item"><button>Copy</button></div></div></div>
        </div>

        <dl>
          First of all decode hex, then encode into base64 to get the flag
        </dl>

        <div class="row-full code">
          <div class="code-toolbar"><pre class=" language-bash"><code class="prism  language-bash">$<span class="token space"> </span>python3<span class="token space"> </span>base.py<span class="token lf">
</span><span class="token comment">#<span class="token space"> </span>b'crypto/Base+64+Encoding+is+Web+Safe/'</span></code></pre><div class="toolbar"><div class="toolbar-item"><button>Copy</button></div></div></div>
        </div>

        <div class="scrolling-wrapper">
        <dl>
          <blockquote>
            <p class="ctf"><strong> crypto/Base+64+Encoding+is+Web+Safe/ </strong></p>
          </blockquote>
        </dl>
        </div>
        <hr>
<!-- Finish post  -->
<!-- Start Post  -->
        <dl class="anchor" id="enc-bytes-bigint">
          <dt> Bytes and Big Integers - Points: 10 </dt>
          <dd>
            Cryptosystems like RSA works  on numbers, but messages are made up of characters. How should we  convert our messages into numbers so that mathematical operations can be  applied? The most common way is to take the ordinal bytes of the  message, convert them into hexadecimal, and concatenate. This can be  interpreted as a base-16 number, and also represented in base-10.
            To illustrate:
          </dd>
        </dl>
        <dl>
          <blockquote>
            <p>
              <strong>message</strong>: HELLO <br>
              <strong>ascii bytes:</strong> [72, 69, 76, 76, 79] <br>
              <strong>hex bytes:</strong> [0x48, 0x45, 0x4c, 0x4c, 0x4f] <br>
              <strong>base-16:</strong> 0x48454c4c4f <br>
              <strong>base-10:</strong> 310400273487 <br>
            </p>
          </blockquote>
        </dl>

        <dl>
          <dd>
             Python's PyCryptodome library implements this with the methods <code>  bytes_to_long </code> and <code> long_to_bytes</code> from <b>Crypto.Util.number</b>. <br>
             Convert the following integer back into a message <br>
             <code>11515195063862318899931685488813747395775516287289682636499965282714637259206269</code>
          </dd>
        </dl>

        <div class="row-full code">
          <div class="code-toolbar"><pre class=" language-python"><code class="prism  language-python"><span class="token keyword keyword-from">from</span><span class="token space"> </span>Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number<span class="token space"> </span><span class="token keyword keyword-import">import</span><span class="token space"> </span>bytes_to_long<span class="token lf">
</span><span class="token keyword keyword-from">from</span><span class="token space"> </span>Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number<span class="token space"> </span><span class="token keyword keyword-import">import</span><span class="token space"> </span>long_to_bytes<span class="token lf">
</span><span class="token lf">
</span>data<span class="token space"> </span><span class="token operator">=</span><span class="token space"> </span><span class="token number">11515195063862318899931685488813747395775516287289682636499965282714637259206269</span><span class="token lf">
</span><span class="token builtin">bytes</span><span class="token space"> </span><span class="token operator">=</span><span class="token space"> </span>long_to_bytes<span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token lf">
</span><span class="token keyword keyword-print">print</span><span class="token punctuation">(</span><span class="token builtin">bytes</span><span class="token punctuation">)</span></code></pre><div class="toolbar"><div class="toolbar-item"><button>Copy</button></div></div></div>
        </div>

        <dl>
          Simply convert long to byte with the respectively function to get the flag
        </dl>

        <div class="row-full code">
          <div class="code-toolbar"><pre class=" language-bash"><code class="prism  language-bash">$<span class="token space"> </span>python3<span class="token space"> </span>flag.py<span class="token lf">
</span><span class="token comment">#<span class="token space"> </span>b'crypto{3nc0d1n6_4ll_7h3_w4y_d0wn}'</span></code></pre><div class="toolbar"><div class="toolbar-item"><button>Copy</button></div></div></div>
        </div>

        <div class="scrolling-wrapper">
        <dl>
          <blockquote>
            <p class="ctf"><strong> crypto{3nc0d1n6_4ll_7h3_w4y_d0wn} </strong></p>
          </blockquote>
        </dl>
        </div>
        <hr>
<!-- Finish post  -->
<!-- Start Post  -->
        <dl class="anchor" id="enc-challenge">
          <dt> Encoding Challenge - Points: 40 </dt>
          <dd>
            Now you've got the hang of the various encodings you'll be encountering, let's have a look at automating it. Can you pass all 100 levels to get the flag? The 13377.py file attached below is the source code for what's running on the server. The pwntools_example.py file provides the start of a solution using the incredibly convenient pwntools library, which you can use if you like (we prefer it over the  telnetlib library, however it's not compatible with Windows). If you're  having trouble getting pwntools to work, then you might want to try basing your answer on the script provided in the Introduction "Network  Attacks" challenge instead.
            Connect at <code>nc socket.cryptohack.org 13377</code>
          </dd>
        </dl>

        <dl>
          <br> Source code on the server
        </dl>

        <div class="row-full code">
          <div class="code-toolbar"><pre class=" language-python"><code class="prism  language-python"><span class="token comment">#!/usr/bin/env<span class="token space"> </span>python3</span><span class="token lf">
</span><span class="token lf">
</span><span class="token keyword keyword-from">from</span><span class="token space"> </span>Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number<span class="token space"> </span><span class="token keyword keyword-import">import</span><span class="token space"> </span>bytes_to_long<span class="token punctuation">,</span><span class="token space"> </span>long_to_bytes<span class="token lf">
</span><span class="token keyword keyword-from">from</span><span class="token space"> </span>utils<span class="token space"> </span><span class="token keyword keyword-import">import</span><span class="token space"> </span>listener<span class="token space"> </span><span class="token comment">#<span class="token space"> </span>this<span class="token space"> </span>is<span class="token space"> </span>cryptohack's<span class="token space"> </span>server-side<span class="token space"> </span>module<span class="token space"> </span>and<span class="token space"> </span>not<span class="token space"> </span>part<span class="token space"> </span>of<span class="token space"> </span>python</span><span class="token lf">
</span><span class="token keyword keyword-import">import</span><span class="token space"> </span>base64<span class="token lf">
</span><span class="token keyword keyword-import">import</span><span class="token space"> </span>codecs<span class="token lf">
</span><span class="token keyword keyword-import">import</span><span class="token space"> </span>random<span class="token lf">
</span><span class="token lf">
</span>FLAG<span class="token space"> </span><span class="token operator">=</span><span class="token space"> </span><span class="token string">"crypto{????????????????????}"</span><span class="token lf">
</span>ENCODINGS<span class="token space"> </span><span class="token operator">=</span><span class="token space"> </span><span class="token punctuation">[</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token string">"base64"</span><span class="token punctuation">,</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token string">"hex"</span><span class="token punctuation">,</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token string">"rot13"</span><span class="token punctuation">,</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token string">"bigint"</span><span class="token punctuation">,</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token string">"utf-8"</span><span class="token punctuation">,</span><span class="token lf">
</span><span class="token punctuation">]</span><span class="token lf">
</span><span class="token lf">
</span><span class="token keyword keyword-with">with</span><span class="token space"> </span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'/usr/share/dict/words'</span><span class="token punctuation">)</span><span class="token space"> </span><span class="token keyword keyword-as">as</span><span class="token space"> </span>f<span class="token punctuation">:</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span>WORDS<span class="token space"> </span><span class="token operator">=</span><span class="token space"> </span><span class="token punctuation">[</span>line<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"'"</span><span class="token punctuation">,</span><span class="token space"> </span><span class="token string">""</span><span class="token punctuation">)</span><span class="token space"> </span><span class="token keyword keyword-for">for</span><span class="token space"> </span>line<span class="token space"> </span><span class="token keyword keyword-in">in</span><span class="token space"> </span>f<span class="token punctuation">.</span>readlines<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token lf">
</span><span class="token lf">
</span><span class="token lf">
</span><span class="token keyword keyword-class">class</span><span class="token space"> </span><span class="token class-name">Challenge</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token keyword keyword-def">def</span><span class="token space"> </span><span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span>self<span class="token punctuation">.</span>challenge_words<span class="token space"> </span><span class="token operator">=</span><span class="token space"> </span><span class="token string">""</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span>self<span class="token punctuation">.</span>stage<span class="token space"> </span><span class="token operator">=</span><span class="token space"> </span><span class="token number">0</span><span class="token lf">
</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token keyword keyword-def">def</span><span class="token space"> </span><span class="token function">create_level</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span>self<span class="token punctuation">.</span>stage<span class="token space"> </span><span class="token operator">+=</span><span class="token space"> </span><span class="token number">1</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span>self<span class="token punctuation">.</span>challenge_words<span class="token space"> </span><span class="token operator">=</span><span class="token space"> </span><span class="token string">"_"</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>random<span class="token punctuation">.</span>choices<span class="token punctuation">(</span>WORDS<span class="token punctuation">,</span><span class="token space"> </span>k<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span>encoding<span class="token space"> </span><span class="token operator">=</span><span class="token space"> </span>random<span class="token punctuation">.</span>choice<span class="token punctuation">(</span>ENCODINGS<span class="token punctuation">)</span><span class="token lf">
</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token keyword keyword-if">if</span><span class="token space"> </span>encoding<span class="token space"> </span><span class="token operator">==</span><span class="token space"> </span><span class="token string">"base64"</span><span class="token punctuation">:</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span>encoded<span class="token space"> </span><span class="token operator">=</span><span class="token space"> </span>base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>self<span class="token punctuation">.</span>challenge_words<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token space"> </span><span class="token comment">#<span class="token space"> </span>wow<span class="token space"> </span>so<span class="token space"> </span>encode</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token keyword keyword-elif">elif</span><span class="token space"> </span>encoding<span class="token space"> </span><span class="token operator">==</span><span class="token space"> </span><span class="token string">"hex"</span><span class="token punctuation">:</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span>encoded<span class="token space"> </span><span class="token operator">=</span><span class="token space"> </span>self<span class="token punctuation">.</span>challenge_words<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token keyword keyword-elif">elif</span><span class="token space"> </span>encoding<span class="token space"> </span><span class="token operator">==</span><span class="token space"> </span><span class="token string">"rot13"</span><span class="token punctuation">:</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span>encoded<span class="token space"> </span><span class="token operator">=</span><span class="token space"> </span>codecs<span class="token punctuation">.</span>encode<span class="token punctuation">(</span>self<span class="token punctuation">.</span>challenge_words<span class="token punctuation">,</span><span class="token space"> </span><span class="token string">'rot_13'</span><span class="token punctuation">)</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token keyword keyword-elif">elif</span><span class="token space"> </span>encoding<span class="token space"> </span><span class="token operator">==</span><span class="token space"> </span><span class="token string">"bigint"</span><span class="token punctuation">:</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span>encoded<span class="token space"> </span><span class="token operator">=</span><span class="token space"> </span><span class="token builtin">hex</span><span class="token punctuation">(</span>bytes_to_long<span class="token punctuation">(</span>self<span class="token punctuation">.</span>challenge_words<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token keyword keyword-elif">elif</span><span class="token space"> </span>encoding<span class="token space"> </span><span class="token operator">==</span><span class="token space"> </span><span class="token string">"utf-8"</span><span class="token punctuation">:</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span>encoded<span class="token space"> </span><span class="token operator">=</span><span class="token space"> </span><span class="token punctuation">[</span><span class="token builtin">ord</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token space"> </span><span class="token keyword keyword-for">for</span><span class="token space"> </span>b<span class="token space"> </span><span class="token keyword keyword-in">in</span><span class="token space"> </span>self<span class="token punctuation">.</span>challenge_words<span class="token punctuation">]</span><span class="token lf">
</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token keyword keyword-return">return</span><span class="token space"> </span><span class="token punctuation">{</span><span class="token string">"type"</span><span class="token punctuation">:</span><span class="token space"> </span>encoding<span class="token punctuation">,</span><span class="token space"> </span><span class="token string">"encoded"</span><span class="token punctuation">:</span><span class="token space"> </span>encoded<span class="token punctuation">}</span><span class="token lf">
</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token comment">#</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token comment">#<span class="token space"> </span>This<span class="token space"> </span>challenge<span class="token space"> </span>function<span class="token space"> </span>is<span class="token space"> </span>called<span class="token space"> </span>on<span class="token space"> </span>your<span class="token space"> </span>input,<span class="token space"> </span>which<span class="token space"> </span>must<span class="token space"> </span>be<span class="token space"> </span>JSON</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token comment">#<span class="token space"> </span>encoded</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token comment">#</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token keyword keyword-def">def</span><span class="token space"> </span><span class="token function">challenge</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span><span class="token space"> </span>your_input<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token keyword keyword-if">if</span><span class="token space"> </span>self<span class="token punctuation">.</span>stage<span class="token space"> </span><span class="token operator">==</span><span class="token space"> </span><span class="token number">0</span><span class="token punctuation">:</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token keyword keyword-return">return</span><span class="token space"> </span>self<span class="token punctuation">.</span>create_level<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token keyword keyword-elif">elif</span><span class="token space"> </span>self<span class="token punctuation">.</span>stage<span class="token space"> </span><span class="token operator">==</span><span class="token space"> </span><span class="token number">100</span><span class="token punctuation">:</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span>self<span class="token punctuation">.</span>exit<span class="token space"> </span><span class="token operator">=</span><span class="token space"> </span><span class="token boolean">True</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token keyword keyword-return">return</span><span class="token space"> </span><span class="token punctuation">{</span><span class="token string">"flag"</span><span class="token punctuation">:</span><span class="token space"> </span>FLAG<span class="token punctuation">}</span><span class="token lf">
</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token keyword keyword-if">if</span><span class="token space"> </span>self<span class="token punctuation">.</span>challenge_words<span class="token space"> </span><span class="token operator">==</span><span class="token space"> </span>your_input<span class="token punctuation">[</span><span class="token string">"decoded"</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token keyword keyword-return">return</span><span class="token space"> </span>self<span class="token punctuation">.</span>create_level<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token lf">
</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token keyword keyword-return">return</span><span class="token space"> </span><span class="token punctuation">{</span><span class="token string">"error"</span><span class="token punctuation">:</span><span class="token space"> </span><span class="token string">"Decoding<span class="token space"> </span>fail"</span><span class="token punctuation">}</span><span class="token lf">
</span><span class="token lf">
</span><span class="token lf">
</span>listener<span class="token punctuation">.</span>start_server<span class="token punctuation">(</span>port<span class="token operator">=</span><span class="token number">13377</span><span class="token punctuation">)</span></code></pre><div class="toolbar"><div class="toolbar-item"><button>Copy</button></div></div></div>
        </div>

        <dl>
          As we can notice from the code above, what happens on the server is: there are 100 stages, at each stage a string is composed by linking 3 randomly words together, where the words come from a list of them read by an external file; the string is then encrypted in some way and finally sent back.
          At each iteration the server also check our answer, basically we need to decode the string and send it back. If we are able to decode all the 100 stages we get our flag
        </dl>

        <div class="row-full code">
          <div class="code-toolbar"><pre class=" language-python"><code class="prism  language-python"><span class="token keyword keyword-from">from</span><span class="token space"> </span>pwn<span class="token space"> </span><span class="token keyword keyword-import">import</span><span class="token space"> </span><span class="token operator">*</span><span class="token space"> </span><span class="token comment">#<span class="token space"> </span>pip<span class="token space"> </span>install<span class="token space"> </span>pwntools</span><span class="token lf">
</span><span class="token keyword keyword-import">import</span><span class="token space"> </span>json<span class="token lf">
</span><span class="token keyword keyword-from">from</span><span class="token space"> </span>Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number<span class="token space"> </span><span class="token keyword keyword-import">import</span><span class="token space"> </span>bytes_to_long<span class="token punctuation">,</span><span class="token space"> </span>long_to_bytes<span class="token lf">
</span><span class="token keyword keyword-import">import</span><span class="token space"> </span>base64<span class="token lf">
</span><span class="token keyword keyword-import">import</span><span class="token space"> </span>codecs<span class="token lf">
</span><span class="token keyword keyword-import">import</span><span class="token space"> </span>random<span class="token lf">
</span><span class="token keyword keyword-from">from</span><span class="token space"> </span>binascii<span class="token space"> </span><span class="token keyword keyword-import">import</span><span class="token space"> </span>unhexlify<span class="token lf">
</span><span class="token lf">
</span><span class="token lf">
</span>r<span class="token space"> </span><span class="token operator">=</span><span class="token space"> </span>remote<span class="token punctuation">(</span><span class="token string">'socket.cryptohack.org'</span><span class="token punctuation">,</span><span class="token space"> </span><span class="token number">13377</span><span class="token punctuation">,</span><span class="token space"> </span>level<span class="token space"> </span><span class="token operator">=</span><span class="token space"> </span><span class="token string">'debug'</span><span class="token punctuation">)</span><span class="token lf">
</span><span class="token lf">
</span><span class="token keyword keyword-def">def</span><span class="token space"> </span><span class="token function">json_recv</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span>line<span class="token space"> </span><span class="token operator">=</span><span class="token space"> </span>r<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token keyword keyword-return">return</span><span class="token space"> </span>json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>line<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token lf">
</span><span class="token lf">
</span><span class="token keyword keyword-def">def</span><span class="token space"> </span><span class="token function">json_send</span><span class="token punctuation">(</span>hsh<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span>request<span class="token space"> </span><span class="token operator">=</span><span class="token space"> </span>json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>hsh<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span>r<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token lf">
</span><span class="token lf">
</span><span class="token keyword keyword-def">def</span><span class="token space"> </span><span class="token function">list_to_string</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span>output<span class="token space"> </span><span class="token operator">=</span><span class="token space"> </span><span class="token string">""</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token keyword keyword-return">return</span><span class="token punctuation">(</span>output<span class="token punctuation">.</span>join<span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token lf">
</span><span class="token lf">
</span><span class="token keyword keyword-for">for</span><span class="token space"> </span>i<span class="token space"> </span><span class="token keyword keyword-in">in</span><span class="token space"> </span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">101</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span>received<span class="token space"> </span><span class="token operator">=</span><span class="token space"> </span>json_recv<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token keyword keyword-if">if</span><span class="token space"> </span><span class="token string">"flag"</span><span class="token space"> </span><span class="token keyword keyword-in">in</span><span class="token space"> </span>received<span class="token punctuation">:</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token keyword keyword-print">print</span><span class="token punctuation">(</span><span class="token string">"\n[*]<span class="token space"> </span>FLAG:<span class="token space"> </span>{}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>received<span class="token punctuation">[</span><span class="token string">"flag"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token keyword keyword-break">break</span><span class="token lf">
</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token keyword keyword-print">print</span><span class="token punctuation">(</span><span class="token string">"\n[-]<span class="token space"> </span>Cycle:<span class="token space"> </span>{}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token keyword keyword-print">print</span><span class="token punctuation">(</span><span class="token string">"[-]<span class="token space"> </span>Received<span class="token space"> </span>type:<span class="token space"> </span>{}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>received<span class="token punctuation">[</span><span class="token string">"type"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token keyword keyword-print">print</span><span class="token punctuation">(</span><span class="token string">"[-]<span class="token space"> </span>Received<span class="token space"> </span>encoded<span class="token space"> </span>value:<span class="token space"> </span>{}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>received<span class="token punctuation">[</span><span class="token string">"encoded"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token lf">
</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span>word<span class="token space"> </span><span class="token operator">=</span><span class="token space"> </span>received<span class="token punctuation">[</span><span class="token string">"encoded"</span><span class="token punctuation">]</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span>encoding<span class="token space"> </span><span class="token operator">=</span><span class="token space"> </span>received<span class="token punctuation">[</span><span class="token string">"type"</span><span class="token punctuation">]</span><span class="token lf">
</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token keyword keyword-if">if</span><span class="token space"> </span>encoding<span class="token space"> </span><span class="token operator">==</span><span class="token space"> </span><span class="token string">"base64"</span><span class="token punctuation">:</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span>decoded<span class="token space"> </span><span class="token operator">=</span><span class="token space"> </span>base64<span class="token punctuation">.</span>b64decode<span class="token punctuation">(</span>word<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf8'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"'"</span><span class="token punctuation">,</span><span class="token space"> </span><span class="token string">'"'</span><span class="token punctuation">)</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token keyword keyword-elif">elif</span><span class="token space"> </span>encoding<span class="token space"> </span><span class="token operator">==</span><span class="token space"> </span><span class="token string">"hex"</span><span class="token punctuation">:</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span>decoded<span class="token space"> </span><span class="token operator">=</span><span class="token space"> </span><span class="token punctuation">(</span>unhexlify<span class="token punctuation">(</span>word<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf8'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"'"</span><span class="token punctuation">,</span><span class="token space"> </span><span class="token string">'"'</span><span class="token punctuation">)</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token keyword keyword-elif">elif</span><span class="token space"> </span>encoding<span class="token space"> </span><span class="token operator">==</span><span class="token space"> </span><span class="token string">"rot13"</span><span class="token punctuation">:</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span>decoded<span class="token space"> </span><span class="token operator">=</span><span class="token space"> </span>codecs<span class="token punctuation">.</span>decode<span class="token punctuation">(</span>word<span class="token punctuation">,</span><span class="token space"> </span><span class="token string">'rot_13'</span><span class="token punctuation">)</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token keyword keyword-elif">elif</span><span class="token space"> </span>encoding<span class="token space"> </span><span class="token operator">==</span><span class="token space"> </span><span class="token string">"bigint"</span><span class="token punctuation">:</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span>decoded<span class="token space"> </span><span class="token operator">=</span><span class="token space"> </span>unhexlify<span class="token punctuation">(</span>word<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"0x"</span><span class="token punctuation">,</span><span class="token space"> </span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf8'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"'"</span><span class="token punctuation">,</span><span class="token space"> </span><span class="token string">'"'</span><span class="token punctuation">)</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token keyword keyword-elif">elif</span><span class="token space"> </span>encoding<span class="token space"> </span><span class="token operator">==</span><span class="token space"> </span><span class="token string">"utf-8"</span><span class="token punctuation">:</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span>decoded<span class="token space"> </span><span class="token operator">=</span><span class="token space"> </span>list_to_string<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">chr</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token space"> </span><span class="token keyword keyword-for">for</span><span class="token space"> </span>b<span class="token space"> </span><span class="token keyword keyword-in">in</span><span class="token space"> </span>word<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token lf">
</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token keyword keyword-print">print</span><span class="token punctuation">(</span><span class="token string">"[-]<span class="token space"> </span>Decoded:<span class="token space"> </span>{}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>decoded<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token keyword keyword-print">print</span><span class="token punctuation">(</span><span class="token string">"[-]<span class="token space"> </span>Decoded<span class="token space"> </span>Type:<span class="token space"> </span>{}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>decoded<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token lf">
</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span>to_send<span class="token space"> </span><span class="token operator">=</span><span class="token space"> </span><span class="token punctuation">{</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token string">"decoded"</span><span class="token punctuation">:</span><span class="token space"> </span>decoded<span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token punctuation">}</span><span class="token lf">
</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span>json_send<span class="token punctuation">(</span>to_send<span class="token punctuation">)</span></code></pre><div class="toolbar"><div class="toolbar-item"><button>Copy</button></div></div></div>
        </div>


        <div class="row-full code">
          <div class="code-toolbar"><pre class=" language-bash"><code class="prism  language-bash">$<span class="token space"> </span>python3<span class="token space"> </span>pwntools_example_f93ca6ccef2def755aa8f6d9aa6e9c5b.py<span class="token lf">
</span><span class="token comment">#<span class="token space"> </span>[+]<span class="token space"> </span>Opening<span class="token space"> </span>connection<span class="token space"> </span>to<span class="token space"> </span>socket.cryptohack.org<span class="token space"> </span>on<span class="token space"> </span>port<span class="token space"> </span>13377:<span class="token space"> </span>Done</span><span class="token lf">
</span><span class="token comment">#<span class="token space"> </span>[DEBUG]<span class="token space"> </span>Received<span class="token space"> </span>0x3e<span class="token space"> </span>bytes:<span class="token space"> </span>b'{"type":<span class="token space"> </span>"rot13",<span class="token space"> </span>"encoded":<span class="token space"> </span>"pbafgnapl_rssrzvanpl_cerccvre"}\n'</span><span class="token lf">
</span><span class="token comment">#<span class="token space"> </span>[-]<span class="token space"> </span>Cycle:<span class="token space"> </span>0</span><span class="token lf">
</span><span class="token comment">#<span class="token space"> </span>[-]<span class="token space"> </span>Received<span class="token space"> </span>type:<span class="token space"> </span>rot13</span><span class="token lf">
</span><span class="token comment">#<span class="token space"> </span>[-]<span class="token space"> </span>Received<span class="token space"> </span>encoded<span class="token space"> </span>value:<span class="token space"> </span>pbafgnapl_rssrzvanpl_cerccvre</span><span class="token lf">
</span><span class="token comment">#<span class="token space"> </span>[-]<span class="token space"> </span>Decoded:<span class="token space"> </span>constancy_effeminacy_preppier</span><span class="token lf">
</span><span class="token comment">#<span class="token space"> </span>[-]<span class="token space"> </span>Decoded<span class="token space"> </span>Type:<span class="token space"> </span>&lt;class<span class="token space"> </span>'str'&gt;</span><span class="token lf">
</span><span class="token comment">#<span class="token space"> </span>[DEBUG]<span class="token space"> </span>Sent<span class="token space"> </span>0x2d<span class="token space"> </span>bytes:<span class="token space"> </span>b'{"decoded":<span class="token space"> </span>"constancy_effeminacy_preppier"}\n'</span><span class="token lf">
</span><span class="token comment">#<span class="token space"> </span>...</span><span class="token lf">
</span><span class="token comment">#<span class="token space"> </span>...</span><span class="token lf">
</span><span class="token comment">#<span class="token space"> </span>[*]<span class="token space"> </span>FLAG:<span class="token space"> </span>crypto{3nc0d3_d3c0d3_3nc0d3}</span></code></pre><div class="toolbar"><div class="toolbar-item"><button>Copy</button></div></div></div>
        </div>

        <div class="scrolling-wrapper">
        <dl>
          <blockquote>
            <p class="ctf"><strong> crypto{3nc0d3_d3c0d3_3nc0d3} </strong></p>
          </blockquote>
        </dl>
        </div>
        <hr>
<!-- Finish post  -->
<!-- Start Post  -->
        <dl class="anchor" id="xor-starter">
          <dt> XOR Starter - Points: 10 </dt>
          <dd>
              XOR is a bitwise operator which returns 0 if the bits are the same, and 1 otherwise. In textbooks the XOR operator is denoted by ⊕, but in most challenges and programming languages you will see the caret ^ used instead.
          </dd>
        </dl>

        <div class="fig-container">
          <figure class="zoom" onmousemove="zoom(event)" style="background-image: url('\img/02-cryptohack-general-xor.png')">
            <img src="img/02-cryptohack-general-xor.png" alt="">
          </figure>
        </div>

        <dl>
          <dd>
            For binary strings we XOR bit by bit: <code> b'0110' ^ b'1010' = b'1100'</code> . We can XOR integers by first converting the integer from decimal to binary. We can XOR strings by first converting each character to the integer representing the Unicode character. Given the string <code>"label"</code>  XOR each character with the integer <code>13</code>. Convert these integers back to a string and submit the flag as <b>codecrypto{new_string}</b>.
          </dd>
        </dl>

        <div class="row-full code">
          <div class="code-toolbar"><pre class=" language-python"><code class="prism  language-python">data<span class="token space"> </span><span class="token operator">=</span><span class="token space"> </span><span class="token string">"label"</span><span class="token lf">
</span>flag<span class="token space"> </span><span class="token operator">=</span><span class="token space"> </span><span class="token string">''</span><span class="token lf">
</span><span class="token lf">
</span><span class="token keyword keyword-for">for</span><span class="token space"> </span>c<span class="token space"> </span><span class="token keyword keyword-in">in</span><span class="token space"> </span>data<span class="token punctuation">:</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span>flag<span class="token space"> </span><span class="token operator">+=</span><span class="token space"> </span><span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token space"> </span><span class="token operator">^</span><span class="token space"> </span><span class="token number">13</span><span class="token punctuation">)</span><span class="token lf">
</span><span class="token lf">
</span><span class="token keyword keyword-print">print</span><span class="token punctuation">(</span><span class="token string">'crypto{{{}}}'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><div class="toolbar"><div class="toolbar-item"><button>Copy</button></div></div></div>
        </div>

        <dl>
          Read character by character and do the xor between the integer value of each character and 13
        </dl>

        <div class="row-full code">
          <div class="code-toolbar"><pre class=" language-bash"><code class="prism  language-bash">$<span class="token space"> </span>python3<span class="token space"> </span>flag.py<span class="token lf">
</span>crypto<span class="token punctuation">{</span>aloha<span class="token punctuation">}</span></code></pre><div class="toolbar"><div class="toolbar-item"><button>Copy</button></div></div></div>
        </div>

        <div class="scrolling-wrapper">
        <dl>
          <blockquote>
            <p class="ctf"><strong> crypto{aloha} </strong></p>
          </blockquote>
        </dl>
        </div>
        <hr>
<!-- Finish post  -->
<!-- Start Post  -->
        <dl class="anchor" id="xor-properties">
          <dt> XOR Properties - Points: 15 </dt>
          <dd>
            In the last challenge, you saw how XOR worked at the level of bits. In this one, we're going to cover the properties of the XOR operation and then use them to undo a chain of operations that have encrypted a flag. Gaining an intuition for how this works will help greatly when you come to attacking real cryptosystems later, especially in the block ciphers category. <br> <br>

            There are four main properties we should consider when we solve challenges using the XOR operator
          </dd>
        </dl>
        <dl>
          <blockquote>
            <p>
              <strong>Commutative</strong>: A ⊕ B = B ⊕ A  <br>
              <strong>Associative:</strong> A ⊕ (B ⊕ C) = (A ⊕ B) ⊕ C <br>
              <strong>Identity:</strong> A ⊕ 0 = A <br>
              <strong>Self-Inverse:</strong> A ⊕ A = 0  <br>
            </p>
          </blockquote>
        </dl>

        <dl>
          <dd>
            Let's break this down. Commutative means that the order of the XOR operations is not important. Associative means that a chain of operations can be carried out without order (we do not need to worry about brackets). The identity is 0, so XOR with 0 "does nothing", and lastly something XOR'd with itself returns zero. <br> <br>

            Let's try this out in action! Below is a series of outputs where three random keys have been XOR'd together and with the flag. Use the above properties to undo the encryption in the final line to obtain the flag.
          </dd>
        </dl>

        <dl>
          <blockquote>
            <p style="font-size:13px;">
              <strong style="font-size:14px;">KEY1</strong> = a6c8b6733c9b22de7bc0253266a3867df55acde8635e19c73313 <br>
<strong style="font-size:14px;">KEY2 ^ KEY1</strong> = 37dcb292030faa90d07eec17e3b1c6d8daf94c35d4c9191a5e1e <br>
<strong style="font-size:14px;">KEY2 ^ KEY3</strong> = c1545756687e7573db23aa1c3452a098b71a7fbf0fddddde5fc1 <br>
<strong style="font-size:13px;">FLAG ^ KEY1 ^ KEY3 ^ KEY2</strong> = 04ee9855208a2cd59091d04767ae47963170d1660df7f56f5faf <br>
            </p>
          </blockquote>
        </dl>

        <dl>
          <blockquote>
            <p><strong>Hint:</strong>  Before you XOR these objects, be sure to decode from hex to bytes. If you have pwntools installed, you have a xor function for byte strings: from pwn import xor </p>
          </blockquote>
        </dl>

        <div class="row-full code">
          <div class="code-toolbar"><pre class=" language-python"><code class="prism  language-python"><span class="token comment">#!/usr/bin/env<span class="token space"> </span>python3</span><span class="token lf">
</span><span class="token keyword keyword-from">from</span><span class="token space"> </span>binascii<span class="token space"> </span><span class="token keyword keyword-import">import</span><span class="token space"> </span>unhexlify<span class="token lf">
</span><span class="token lf">
</span><span class="token keyword keyword-def">def</span><span class="token space"> </span><span class="token function">xor_two_str</span><span class="token punctuation">(</span>s1<span class="token punctuation">,</span>s2<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token keyword keyword-if">if</span><span class="token space"> </span><span class="token builtin">len</span><span class="token punctuation">(</span>str1<span class="token punctuation">)</span><span class="token space"> </span><span class="token operator">!=</span><span class="token space"> </span><span class="token builtin">len</span><span class="token punctuation">(</span>str2<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token keyword keyword-raise">raise</span><span class="token space"> </span><span class="token string">"XOR<span class="token space"> </span>EXCEPTION:<span class="token space"> </span>Strings<span class="token space"> </span>are<span class="token space"> </span>not<span class="token space"> </span>of<span class="token space"> </span>equal<span class="token space"> </span>length!"</span><span class="token lf">
</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token keyword keyword-return">return</span><span class="token space"> </span><span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span><span class="token space"> </span><span class="token number">16</span><span class="token punctuation">)</span><span class="token space"> </span><span class="token operator">^</span><span class="token space"> </span><span class="token builtin">int</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span><span class="token space"> </span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token space"> </span><span class="token string">'x'</span><span class="token punctuation">)</span><span class="token space"> </span><span class="token keyword keyword-for">for</span><span class="token space"> </span>a<span class="token punctuation">,</span>b<span class="token space"> </span><span class="token keyword keyword-in">in</span><span class="token space"> </span><span class="token builtin">zip</span><span class="token punctuation">(</span>s1<span class="token punctuation">,</span>s2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token lf">
</span><span class="token lf">
</span><span class="token lf">
</span>KEY1<span class="token space"> </span><span class="token operator">=</span><span class="token space"> </span><span class="token string">"a6c8b6733c9b22de7bc0253266a3867df55acde8635e19c73313"</span><span class="token lf">
</span><span class="token lf">
</span>KEY2<span class="token space"> </span><span class="token operator">=</span><span class="token space"> </span>xor_two_str<span class="token punctuation">(</span><span class="token string">"37dcb292030faa90d07eec17e3b1c6d8daf94c35d4c9191a5e1e"</span><span class="token punctuation">,</span><span class="token space"> </span>KEY1<span class="token punctuation">)</span><span class="token lf">
</span><span class="token keyword keyword-print">print</span><span class="token punctuation">(</span><span class="token string">"[-]<span class="token space"> </span>KEY2:<span class="token space"> </span>{}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>KEY2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token lf">
</span><span class="token lf">
</span>KEY3<span class="token space"> </span><span class="token operator">=</span><span class="token space"> </span>xor_two_str<span class="token punctuation">(</span><span class="token string">"c1545756687e7573db23aa1c3452a098b71a7fbf0fddddde5fc1"</span><span class="token punctuation">,</span><span class="token space"> </span>KEY2<span class="token punctuation">)</span><span class="token lf">
</span><span class="token keyword keyword-print">print</span><span class="token punctuation">(</span><span class="token string">"[-]<span class="token space"> </span>KEY3:<span class="token space"> </span>{}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>KEY3<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token lf">
</span><span class="token lf">
</span>KEY4<span class="token space"> </span><span class="token operator">=</span><span class="token space"> </span>xor_two_str<span class="token punctuation">(</span>xor_two_str<span class="token punctuation">(</span>KEY1<span class="token punctuation">,</span><span class="token space"> </span>KEY2<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token space"> </span>KEY3<span class="token punctuation">)</span><span class="token lf">
</span><span class="token keyword keyword-print">print</span><span class="token punctuation">(</span><span class="token string">"[-]<span class="token space"> </span>KEY4:<span class="token space"> </span>{}\n"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>KEY4<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token lf">
</span><span class="token lf">
</span>FLAG<span class="token space"> </span><span class="token operator">=</span><span class="token space"> </span>xor_two_str<span class="token punctuation">(</span><span class="token string">"04ee9855208a2cd59091d04767ae47963170d1660df7f56f5faf"</span><span class="token punctuation">,</span><span class="token space"> </span>KEY4<span class="token punctuation">)</span><span class="token lf">
</span><span class="token keyword keyword-print">print</span><span class="token punctuation">(</span><span class="token string">"[*]<span class="token space"> </span>FLAG:<span class="token space"> </span>{}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>unhexlify<span class="token punctuation">(</span>FLAG<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><div class="toolbar"><div class="toolbar-item"><button>Copy</button></div></div></div>
        </div>

        <dl>
          As we can see from the proposed keys, the only applicable property is the commutative one. Let's apply it to get KEY2 from KEY1 and then do the same for the remaining KEYs. Finally we get the flag in hex format, decoding it we get the flag
        </dl>

        <div class="row-full code">
          <div class="code-toolbar"><pre class=" language-bash"><code class="prism  language-bash">$<span class="token space"> </span>python3<span class="token space"> </span>flag.py<span class="token lf">
</span><span class="token comment">#<span class="token space"> </span>[-]<span class="token space"> </span>KEY2:<span class="token space"> </span>911404e13f94884eabbec925851240a52fa381ddb79700dd6d0d</span><span class="token lf">
</span><span class="token comment">#<span class="token space"> </span>[-]<span class="token space"> </span>KEY3:<span class="token space"> </span>504053b757eafd3d709d6339b140e03d98b9fe62b84add0332cc</span><span class="token lf">
</span><span class="token comment">#<span class="token space"> </span>[-]<span class="token space"> </span>KEY4:<span class="token space"> </span>679ce12554e557ada0e38f2e52f126e54240b2576c83c4196cd2</span><span class="token lf">
</span><span class="token comment">#</span><span class="token lf">
</span><span class="token comment">#<span class="token space"> </span>[*]<span class="token space"> </span>FLAG:<span class="token space"> </span>b'crypto{x0r_i5_ass0c1at1v3}'</span></code></pre><div class="toolbar"><div class="toolbar-item"><button>Copy</button></div></div></div>
        </div>

        <div class="scrolling-wrapper">
        <dl>
          <blockquote>
            <p class="ctf"><strong> crypto{x0r_i5_ass0c1at1v3} </strong></p>
          </blockquote>
        </dl>
        </div>
        <hr>
<!-- Finish post  -->
<!-- Start Post  -->
        <dl class="anchor" id="xor-fav-byte">
          <dt> Favourite byte - Points: 20 </dt>
          <dd>
              I've hidden my data using XOR with a single byte. Don't forget to decode from hex first. <code> 73626960647f6b206821204f21254f7d694f7624662065622127234f726927756d </code>
          </dd>
        </dl>


        <div class="row-full code">
          <div class="code-toolbar"><pre class=" language-python"><code class="prism  language-python"><span class="token keyword keyword-from">from</span><span class="token space"> </span>binascii<span class="token space"> </span><span class="token keyword keyword-import">import</span><span class="token space"> </span>unhexlify<span class="token lf">
</span><span class="token keyword keyword-import">import</span><span class="token space"> </span>string<span class="token lf">
</span><span class="token lf">
</span><span class="token keyword keyword-def">def</span><span class="token space"> </span><span class="token function">single_byte_xor</span><span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">,</span><span class="token space"> </span>key<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token keyword keyword-if">if</span><span class="token space"> </span><span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token space"> </span><span class="token operator">!=</span><span class="token space"> </span><span class="token number">1</span><span class="token punctuation">:</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token keyword keyword-raise">raise</span><span class="token space"> </span><span class="token string">"KEY<span class="token space"> </span>LENGTH<span class="token space"> </span>EXCEPTION:<span class="token space"> </span>In<span class="token space"> </span>single_byte_xor<span class="token space"> </span>key<span class="token space"> </span>must<span class="token space"> </span>be<span class="token space"> </span>1<span class="token space"> </span>byte<span class="token space"> </span>long!"</span><span class="token lf">
</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span>output<span class="token space"> </span><span class="token operator">=</span><span class="token space"> </span><span class="token string">b''</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token keyword keyword-for">for</span><span class="token space"> </span>b<span class="token space"> </span><span class="token keyword keyword-in">in</span><span class="token space"> </span><span class="token builtin">input</span><span class="token punctuation">:</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span>output<span class="token space"> </span><span class="token operator">+=</span><span class="token space"> </span><span class="token builtin">bytes</span><span class="token punctuation">(</span><span class="token punctuation">[</span>b<span class="token space"> </span><span class="token operator">^</span><span class="token space"> </span>key<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token lf">
</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token keyword keyword-try">try</span><span class="token punctuation">:</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token keyword keyword-return">return</span><span class="token space"> </span>output<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token keyword keyword-except">except</span><span class="token punctuation">:</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token keyword keyword-return">return</span><span class="token space"> </span><span class="token string">"Cannot<span class="token space"> </span>Decode<span class="token space"> </span>some<span class="token space"> </span>bytes"</span><span class="token lf">
</span><span class="token lf">
</span>data<span class="token space"> </span><span class="token operator">=</span><span class="token space"> </span><span class="token string">"73626960647f6b206821204f21254f7d694f7624662065622127234f726927756d"</span><span class="token lf">
</span>decoded<span class="token space"> </span><span class="token operator">=</span><span class="token space"> </span>unhexlify<span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token lf">
</span><span class="token lf">
</span><span class="token keyword keyword-print">print</span><span class="token punctuation">(</span><span class="token string">"[-]<span class="token space"> </span>HEX_DECODE:<span class="token space"> </span>{}\n"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>decoded<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token lf">
</span><span class="token lf">
</span>result<span class="token space"> </span><span class="token operator">=</span><span class="token space"> </span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token lf">
</span><span class="token keyword keyword-for">for</span><span class="token space"> </span>i<span class="token space"> </span><span class="token keyword keyword-in">in</span><span class="token space"> </span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span>result<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token space"> </span><span class="token operator">=</span><span class="token space"> </span><span class="token punctuation">(</span>single_byte_xor<span class="token punctuation">(</span>decoded<span class="token punctuation">,</span><span class="token space"> </span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token comment">#print("[-]<span class="token space"> </span>KEY:<span class="token space"> </span>{}\nSTRING:<span class="token space"> </span>{}".format(i,single_byte_xor(decoded,<span class="token space"> </span>i)))</span><span class="token lf">
</span><span class="token lf">
</span><span class="token keyword keyword-print">print</span><span class="token punctuation">(</span><span class="token string">"[*]<span class="token space"> </span>FLAG:<span class="token space"> </span>{}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token punctuation">[</span>s<span class="token space"> </span><span class="token keyword keyword-for">for</span><span class="token space"> </span>s<span class="token space"> </span><span class="token keyword keyword-in">in</span><span class="token space"> </span>result<span class="token punctuation">.</span>values<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token space"> </span><span class="token keyword keyword-if">if</span><span class="token space"> </span><span class="token string">"crypto"</span><span class="token space"> </span><span class="token keyword keyword-in">in</span><span class="token space"> </span>s<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><div class="toolbar"><div class="toolbar-item"><button>Copy</button></div></div></div>
        </div>

        <dl>
          This is a single byte XOR-cypher. In order to break it we need to xor each single byte of our decoded data with one single byte at time. Iterating through all the possible bytes we finally get our flag
        </dl>

        <div class="row-full code">
          <div class="code-toolbar"><pre class=" language-bash"><code class="prism  language-bash">$<span class="token space"> </span>python3<span class="token space"> </span>flag.py<span class="token lf">
</span><span class="token comment">#<span class="token space"> </span>[-]<span class="token space"> </span>HEX_DECODE:<span class="token space"> </span>b"sbi`d\x7fk<span class="token space"> </span>h!<span class="token space"> </span>O!%O}iOv$f<span class="token space"> </span>eb!'#Ori'um"</span><span class="token lf">
</span><span class="token comment">#<span class="token space"> </span>...</span><span class="token lf">
</span><span class="token comment">#<span class="token space"> </span>[*]<span class="token space"> </span>FLAG:<span class="token space"> </span>['crypto{0x10_15_my_f4v0ur173_by7e}']</span></code></pre><div class="toolbar"><div class="toolbar-item"><button>Copy</button></div></div></div>
        </div>

        <div class="scrolling-wrapper">
        <dl>
          <blockquote>
            <p class="ctf"><strong> crypto{0x10_15_my_f4v0ur173_by7e} </strong></p>
          </blockquote>
        </dl>
        </div>
        <hr>
<!-- Finish post  -->
<!-- Start Post  -->
        <dl class="anchor" id="xor-know-xor-dont">
          <dt> You either know, XOR you don't - Points: 30 </dt>
          <dd>
              I've encrypted the flag with my secret key, you'll never be able to guess it <code>e0b213f26041e480b26217f27342e175d0e070a3c5b103e2526217f27342e175d0e077e263451150104 </code>
          </dd>
        </dl>

        <dl>
          <blockquote>
            <p><strong>Hint:</strong>  Remember the flag format and how it might help you in this challenge! </p>
          </blockquote>
        </dl>


        <div class="row-full code">
          <div class="code-toolbar"><pre class=" language-python"><code class="prism  language-python"><span class="token keyword keyword-from">from</span><span class="token space"> </span>binascii<span class="token space"> </span><span class="token keyword keyword-import">import</span><span class="token space"> </span>unhexlify<span class="token lf">
</span><span class="token lf">
</span><span class="token keyword keyword-def">def</span><span class="token space"> </span><span class="token function">brute</span><span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">,</span><span class="token space"> </span>key<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token keyword keyword-if">if</span><span class="token space"> </span><span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">)</span><span class="token space"> </span><span class="token operator">!=</span><span class="token space"> </span><span class="token builtin">len</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token keyword keyword-return">return</span><span class="token space"> </span><span class="token string">"Failed!"</span><span class="token lf">
</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span>output<span class="token space"> </span><span class="token operator">=</span><span class="token space"> </span><span class="token string">b''</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token keyword keyword-for">for</span><span class="token space"> </span>b1<span class="token punctuation">,</span><span class="token space"> </span>b2<span class="token space"> </span><span class="token keyword keyword-in">in</span><span class="token space"> </span><span class="token builtin">zip</span><span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">,</span><span class="token space"> </span>key<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span>output<span class="token space"> </span><span class="token operator">+=</span><span class="token space"> </span><span class="token builtin">bytes</span><span class="token punctuation">(</span><span class="token punctuation">[</span>b1<span class="token space"> </span><span class="token operator">^</span><span class="token space"> </span>b2<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token keyword keyword-try">try</span><span class="token punctuation">:</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token keyword keyword-return">return</span><span class="token space"> </span>output<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token keyword keyword-except">except</span><span class="token punctuation">:</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token keyword keyword-return">return</span><span class="token space"> </span><span class="token string">"Cannot<span class="token space"> </span>Decode<span class="token space"> </span>some<span class="token space"> </span>bytes"</span><span class="token lf">
</span><span class="token lf">
</span>data<span class="token space"> </span><span class="token operator">=</span><span class="token space"> </span><span class="token string">"0e0b213f26041e480b26217f27342e175d0e070a3c5b103e2526217f27342e175d0e077e263451150104"</span><span class="token lf">
</span>cipher<span class="token space"> </span><span class="token operator">=</span><span class="token space"> </span>unhexlify<span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token lf">
</span><span class="token keyword keyword-print">print</span><span class="token punctuation">(</span><span class="token string">"[-]<span class="token space"> </span>CIPHER:<span class="token space"> </span>{}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>cipher<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token lf">
</span><span class="token lf">
</span><span class="token comment">#<span class="token space"> </span>First<span class="token space"> </span>Step</span><span class="token lf">
</span>key_part<span class="token space"> </span><span class="token operator">=</span><span class="token space"> </span>brute<span class="token punctuation">(</span>cipher<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token space"> </span><span class="token string">"crypto{"</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token lf">
</span><span class="token keyword keyword-print">print</span><span class="token punctuation">(</span><span class="token string">"[-]<span class="token space"> </span>PARTIAL<span class="token space"> </span>KEY<span class="token space"> </span>FOUND:<span class="token space"> </span>{}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>key_part<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token lf">
</span><span class="token lf">
</span><span class="token comment">#<span class="token space"> </span>Second<span class="token space"> </span>Step</span><span class="token lf">
</span>key<span class="token space"> </span><span class="token operator">=</span><span class="token space"> </span><span class="token punctuation">(</span>key_part<span class="token space"> </span><span class="token operator">+</span><span class="token space"> </span><span class="token string">"y"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token lf">
</span>key<span class="token space"> </span><span class="token operator">+=</span><span class="token space"> </span>key<span class="token space"> </span><span class="token operator">*</span><span class="token space"> </span><span class="token builtin">int</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>cipher<span class="token punctuation">)</span><span class="token space"> </span><span class="token operator">-</span><span class="token space"> </span><span class="token builtin">len</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token builtin">len</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token lf">
</span>key<span class="token space"> </span><span class="token operator">+=</span><span class="token space"> </span>key<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>cipher<span class="token punctuation">)</span><span class="token space"> </span><span class="token operator">-</span><span class="token space"> </span><span class="token builtin">len</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token builtin">len</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token lf">
</span><span class="token keyword keyword-print">print</span><span class="token punctuation">(</span><span class="token string">"[-]<span class="token space"> </span>Decoding<span class="token space"> </span>using<span class="token space"> </span>KEY:<span class="token space"> </span>{}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token lf">
</span><span class="token lf">
</span>plain<span class="token space"> </span><span class="token operator">=</span><span class="token space"> </span>brute<span class="token punctuation">(</span>cipher<span class="token punctuation">,</span><span class="token space"> </span>key<span class="token punctuation">)</span><span class="token lf">
</span><span class="token keyword keyword-print">print</span><span class="token punctuation">(</span><span class="token string">"\n[*]<span class="token space"> </span>FLAG:<span class="token space"> </span>{}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>plain<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><div class="toolbar"><div class="toolbar-item"><button>Copy</button></div></div></div>
        </div>

        <dl>
          We know that is a XOR-cipher, the first thing we can try, as suggested, it's to look for a part of the key by xoring the first seven character of the FLAG which is <code>"crypto{"</code> and the same number of character from our ciphertext (code section <i>"First Step"</i>). <br>
          As result we have <code>"myXORke"</code>. By using not so much immgination we can try <b>myXORkey</b> as key and by repeating it over the lenght of our ciphertext and xoring with all the cipher we get our flag (code section <i>"Second Step"</i>).
        </dl>

        <div class="row-full code">
          <div class="code-toolbar"><pre class=" language-bash"><code class="prism  language-bash">$<span class="token space"> </span>python3<span class="token space"> </span>flag.py<span class="token lf">
</span><span class="token comment">#<span class="token space"> </span>[-]<span class="token space"> </span>CIPHER:<span class="token space"> </span>#<span class="token space"> </span></span><span class="token lf">
</span>b<span class="token string">"<span class="token entity" title="\x0e">\x0e</span><span class="token entity" title="\x0b">\x0b</span>!?&amp;<span class="token entity" title="\x04">\x04</span><span class="token entity" title="\x1e">\x1e</span>H<span class="token entity" title="\x0b">\x0b</span>&amp;!<span class="token entity" title="\x7f">\x7f</span>'4.<span class="token entity" title="\x17">\x17</span>]<span class="token entity" title="\x0e">\x0e</span><span class="token entity" title="\x07">\x07</span><span class="token entity" title="\n">\n</span>&lt;[<span class="token entity" title="\x10">\x10</span>&gt;%&amp;!<span class="token entity" title="\x7f">\x7f</span>'4.<span class="token entity" title="\x17">\x17</span>]<span class="token entity" title="\x0e">\x0e</span><span class="token entity" title="\x07">\x07</span>~&amp;4Q<span class="token entity" title="\x15">\x15</span><span class="token entity" title="\x01">\x01</span><span class="token entity" title="\x04">\x04</span>"</span><span class="token lf">
</span><span class="token comment">#<span class="token space"> </span>[-]<span class="token space"> </span>PARTIAL<span class="token space"> </span>KEY<span class="token space"> </span>FOUND:<span class="token space"> </span>myXORke</span><span class="token lf">
</span><span class="token comment">#<span class="token space"> </span>[-]<span class="token space"> </span>Decoding<span class="token space"> </span>using<span class="token space"> </span>KEY:<span class="token space"> </span>b'myXORkeymyXORkeymyXORkeymyXORkeymyXORkeymy'</span><span class="token lf">
</span><span class="token comment">#<span class="token space"> </span>...</span><span class="token lf">
</span><span class="token comment">#<span class="token space"> </span>[*]<span class="token space"> </span>FLAG:<span class="token space"> </span>crypto{1f_y0u_Kn0w_En0uGH_y0u_Kn0w_1t_4ll}</span></code></pre><div class="toolbar"><div class="toolbar-item"><button>Copy</button></div></div></div>
        </div>

        <div class="scrolling-wrapper">
        <dl>
          <blockquote>
            <p class="ctf"><strong> crypto{1f_y0u_Kn0w_En0uGH_y0u_Kn0w_1t_4ll} </strong></p>
          </blockquote>
        </dl>
        </div>
        <hr>
<!-- Finish post  -->
<!-- Start Post  -->
        <dl class="anchor" id="math-gcd">
          <dt> Greatest Common Divisor - Points: 15 </dt>
          <dd>
            The Greatest Common Divisor (GCD), sometimes known as the highest common factor, is the largest number which divides two positive integers (a,b). For a = 12, b = 8 we can calculate the divisors of a: {1,2,3,4,6,12} and the divisors of b: {1,2,4,8}. Comparing these two, we see that gcd(a,b) = 4. Now imagine we take a = 11, b = 17. Both a and b are prime numbers. As a prime number has only itself and 1 as divisors, gcd(a,b) = 1. We say that for any two integers a,b, if gcd(a,b) = 1 then a and b are coprime integers. If a and b are prime, they are also coprime. If a is prime and b &lt; a then a and b are coprime.
          </dd>
        </dl>

        <dl>
          <blockquote>
            <p><strong>Hint:</strong>  Think about the case for a prime and b &gt; a, why are these not necessarily coprime? </p>
          </blockquote>
        </dl>

        <dl>
          There are many tools to calculate the GCD of two integers, but for this task we recommend looking up <b>Euclid's Algorithm</b>. Try coding it up; it's only a couple of lines. Use a = 12, b = 8 to test it. Now calculate gcd(a,b) for a = 66528, b = 52920 and enter it below.
        </dl>

        <div class="row-full code">
          <div class="code-toolbar"><pre class=" language-python"><code class="prism  language-python"><span class="token keyword keyword-def">def</span><span class="token space"> </span><span class="token function">euclid_gcd</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span><span class="token space"> </span>y<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token keyword keyword-if">if</span><span class="token space"> </span>x<span class="token space"> </span><span class="token operator">&lt;</span><span class="token space"> </span>y<span class="token punctuation">:</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token keyword keyword-return">return</span><span class="token space"> </span>euclid_gcd<span class="token punctuation">(</span>y<span class="token punctuation">,</span><span class="token space"> </span>x<span class="token punctuation">)</span><span class="token lf">
</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token keyword keyword-while">while</span><span class="token space"> </span>y<span class="token space"> </span><span class="token operator">!=</span><span class="token space"> </span><span class="token number">0</span><span class="token punctuation">:</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token punctuation">(</span>x<span class="token punctuation">,</span><span class="token space"> </span>y<span class="token punctuation">)</span><span class="token space"> </span><span class="token operator">=</span><span class="token space"> </span><span class="token punctuation">(</span>y<span class="token punctuation">,</span><span class="token space"> </span>x<span class="token space"> </span><span class="token operator">%</span><span class="token space"> </span>y<span class="token punctuation">)</span><span class="token lf">
</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token keyword keyword-print">print</span><span class="token punctuation">(</span><span class="token string">"\n[+]<span class="token space"> </span>GCD:<span class="token space"> </span>{}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token keyword keyword-return">return</span><span class="token space"> </span>x<span class="token lf">
</span><span class="token lf">
</span><span class="token comment">#<span class="token space"> </span>a<span class="token space"> </span>=<span class="token space"> </span>12</span><span class="token lf">
</span><span class="token comment">#<span class="token space"> </span>b<span class="token space"> </span>=<span class="token space"> </span>8</span><span class="token lf">
</span><span class="token lf">
</span>a<span class="token space"> </span><span class="token operator">=</span><span class="token space"> </span><span class="token number">66528</span><span class="token lf">
</span>b<span class="token space"> </span><span class="token operator">=</span><span class="token space"> </span><span class="token number">52920</span><span class="token lf">
</span><span class="token lf">
</span>euclid_gcd<span class="token punctuation">(</span>a<span class="token punctuation">,</span><span class="token space"> </span>b<span class="token punctuation">)</span></code></pre><div class="toolbar"><div class="toolbar-item"><button>Copy</button></div></div></div>
        </div>

        <dl>
          Simply calculate the GCD using the Euclidean algorithm.
        </dl>

        <div class="row-full code">
          <div class="code-toolbar"><pre class=" language-bash"><code class="prism  language-bash">$<span class="token space"> </span>python3<span class="token space"> </span>flag.py<span class="token lf">
</span><span class="token comment">#<span class="token space"> </span>[+]<span class="token space"> </span>GCD:<span class="token space"> </span>1512</span></code></pre><div class="toolbar"><div class="toolbar-item"><button>Copy</button></div></div></div>
        </div>

        <div class="scrolling-wrapper">
        <dl>
          <blockquote>
            <p class="ctf"><strong> 1512 </strong></p>
          </blockquote>
        </dl>
        </div>
        <hr>
<!-- Finish post  -->
<!-- Start Post  -->
        <dl class="anchor" id="math-extended-gcd">
          <dt> Extended GCD - Points: 20 </dt>
          <dd>
            Let a and b be positive integers.
            The extended Euclidean algorithm is an efficient way to find integers u,v such that: <br> <br>
            <b style="margin-left: 20%"> a * u + b * v = gcd(a,b) </b>
          </dd>
        </dl>

        <dl>
          <blockquote>
            <p><strong>Hint:</strong>  Later, when we learn to decrypt RSA, we will need this algorithm to calculate the modular inverse of the public exponent. </p>
          </blockquote>
        </dl>

        <dl>
          Using the two primes p = 26513, q = 32321, find the integers u,v such that: <br>
          <b style="margin-left: 20%"> p * u + q * v = gcd(p,q) </b> <br>
        </dl>

        <dl>
          <blockquote>
            <p><strong>Hint:</strong> Knowing that p,q are prime, what would you expect gcd(p,q) to be? </p>
          </blockquote>
        </dl>

        <div class="row-full code">
          <div class="code-toolbar"><pre class=" language-python"><code class="prism  language-python"><span class="token keyword keyword-def">def</span><span class="token space"> </span><span class="token function">extended_gcd</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span>q<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token keyword keyword-if">if</span><span class="token space"> </span>p<span class="token space"> </span><span class="token operator">==</span><span class="token space"> </span><span class="token number">0</span><span class="token punctuation">:</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token keyword keyword-return">return</span><span class="token space"> </span><span class="token punctuation">(</span>q<span class="token punctuation">,</span><span class="token space"> </span><span class="token number">0</span><span class="token punctuation">,</span><span class="token space"> </span><span class="token number">1</span><span class="token punctuation">)</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token keyword keyword-else">else</span><span class="token punctuation">:</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token punctuation">(</span>gcd<span class="token punctuation">,</span><span class="token space"> </span>u<span class="token punctuation">,</span><span class="token space"> </span>v<span class="token punctuation">)</span><span class="token space"> </span><span class="token operator">=</span><span class="token space"> </span>extended_gcd<span class="token punctuation">(</span>q<span class="token space"> </span><span class="token operator">%</span><span class="token space"> </span>p<span class="token punctuation">,</span><span class="token space"> </span>p<span class="token punctuation">)</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token keyword keyword-return">return</span><span class="token space"> </span><span class="token punctuation">(</span>gcd<span class="token punctuation">,</span><span class="token space"> </span>v<span class="token space"> </span><span class="token operator">-</span><span class="token space"> </span><span class="token punctuation">(</span>q<span class="token space"> </span><span class="token operator">//</span><span class="token space"> </span>p<span class="token punctuation">)</span><span class="token space"> </span><span class="token operator">*</span><span class="token space"> </span>u<span class="token punctuation">,</span><span class="token space"> </span>u<span class="token punctuation">)</span><span class="token lf">
</span><span class="token lf">
</span>p<span class="token space"> </span><span class="token operator">=</span><span class="token space"> </span><span class="token number">26513</span><span class="token lf">
</span>q<span class="token space"> </span><span class="token operator">=</span><span class="token space"> </span><span class="token number">32321</span><span class="token lf">
</span><span class="token lf">
</span>gcd<span class="token punctuation">,</span><span class="token space"> </span>u<span class="token punctuation">,</span><span class="token space"> </span>v<span class="token space"> </span><span class="token operator">=</span><span class="token space"> </span>extended_gcd<span class="token punctuation">(</span>p<span class="token punctuation">,</span><span class="token space"> </span>q<span class="token punctuation">)</span><span class="token lf">
</span><span class="token keyword keyword-print">print</span><span class="token punctuation">(</span><span class="token string">"[+]<span class="token space"> </span>GCD:<span class="token space"> </span>{}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>gcd<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token lf">
</span><span class="token keyword keyword-print">print</span><span class="token punctuation">(</span><span class="token string">"[+]<span class="token space"> </span>u,v:<span class="token space"> </span>{},{}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>u<span class="token punctuation">,</span>v<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token lf">
</span><span class="token keyword keyword-print">print</span><span class="token punctuation">(</span><span class="token string">"\n[*]<span class="token space"> </span>FLAG:<span class="token space"> </span>crypto{{{},{}}}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>u<span class="token punctuation">,</span>v<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><div class="toolbar"><div class="toolbar-item"><button>Copy</button></div></div></div>
        </div>

        <dl>
        </dl>

        <div class="row-full code">
          <div class="code-toolbar"><pre class=" language-bash"><code class="prism  language-bash">$<span class="token space"> </span>python3<span class="token space"> </span>flag.py<span class="token lf">
</span><span class="token comment">#<span class="token space"> </span>[+]<span class="token space"> </span>GCD:<span class="token space"> </span>1</span><span class="token lf">
</span><span class="token comment">#<span class="token space"> </span>[+]<span class="token space"> </span>u,v:<span class="token space"> </span>10245,-8404</span><span class="token lf">
</span><span class="token comment">#</span><span class="token lf">
</span><span class="token comment">#<span class="token space"> </span>[*]<span class="token space"> </span>FLAG:<span class="token space"> </span>crypto{10245,-8404}</span></code></pre><div class="toolbar"><div class="toolbar-item"><button>Copy</button></div></div></div>
        </div>

        <div class="scrolling-wrapper">
        <dl>
          <blockquote>
            <p class="ctf"><strong> crypto{10245,-8404} </strong></p>
          </blockquote>
        </dl>
        </div>
        <hr>
<!-- Finish post  -->


    	</article>

      <section class="" role="group">
        <button id="previous" onclick="location.href='introduction.html'"> Previous </button>
        <button id="next" onclick="location.href='#'"> Next </button>
        <br> <br> <br>
      </section>

      </div>
    </main>
    <footer>
        <p>Copyright © 2022</p>
    </footer>
</body>
</html>
